"use strict";var tmplPath="../",sounds={success:"".concat(tmplPath,"php/audio/success.mp3"),error:"".concat(tmplPath,"php/audio/error-1.mp3")},soundSuccess=new Sound(sounds.success),soundError=new Sound(sounds.error),alertSound=soundSuccess;function Sound(e){var s=document.createElement("audio");s.src=e,this.play=function(){s.play()}}var forms=Array.from(document.forms);function setupLoader(e){var s=document.createElement("div");s.className="submit-loader submit-loader_fixed",wrapper.appendChild(s)}function removeLoader(e){wrapper.querySelector(".submit-loader").remove()}forms.forEach(function(c){var e=c.querySelector('input[type="file"]'),i=e.nextElementSibling,a=(e.addEventListener("change",function(){1==this.files.length&&(i.innerHTML='<div class="form__file_selected-label">Выбран файл: </div><div class="form__file_selected-value">'.concat(this.files[0].name,"</div>")),1<this.files.length&&(i.innerHTML='<div class="form__file_selected-label">Выбрано файлов: </div><div class="form__file_selected-value">'.concat(this.files.length,"</div>"))}),c.querySelectorAll("[data-required]"));a.forEach(function(e){e.oninput=function(){this.classList.remove("not-valid")}}),c.addEventListener("submit",function(e){var r,s="".concat(tmplPath,"php/send-order.php");function t(){var s=!0;return a.forEach(function(e){""===e.value.trim()&&(e.value="",e.classList.add("not-valid"),s=!1,"userName"===e.name&&(e.placeholder="Укажите ваше имя"),"userPhone"===e.name&&(e.placeholder="Укажите ваш телефон"),"userEmail"===e.name)&&(e.placeholder="Укажите ваш email")}),s}e.preventDefault?e.preventDefault():e.returnValue=!1,t()?(setupLoader(c),(r=new XMLHttpRequest).open("POST",s,!0),r.onload=function(){var e=document.createElement("div"),s=document.createElement("div"),t=document.createElement("div"),a=document.createElement("div");a.className="thanks__backdrop";function n(){e.classList.remove("active"),e.style.animation="slideUpOut .5s ease forwards",setTimeout(function(){e.remove(),a.remove()},500)}e.className="thanks",s.className="thanks__content",t.className="thanks__close",e.append(s,t),wrapper.append(e),e.before(a),t.onclick=function(){n()},removeLoader(c),200<=r.status&&r.status<400?(t=JSON.parse(this.response),alertSound="success"==t.result?(s.innerHTML='<div class="thanks__title"><span class="text_accent-prim">Спасибо,</span> ваш заказ отправлен!</div><div class="thanks__subtitle">В ближайшее время с вами свяжется наш специалист</div>',e.classList.remove("thanks_error"),e.classList.add("thanks_success"),soundSuccess):("limitExceeded"==t.result?s.innerHTML='<div class="thanks__title"><span class="text_accent-prim">Ошибка.</span></div><div class="thanks__subtitle">Превышен максимальный размер прикрепляемых файлов (10мб).</div>':s.innerHTML='<div class="thanks__title"><span class="text_accent-prim">Ошибка.</span></div><div class="thanks__subtitle">Сообщение не отправлено.</div>',e.classList.remove("thanks_success"),e.classList.add("thanks_error"),soundError)):alert("Ошибка сервера. Номер: "+r.status),e.classList.add("active"),alertSound.play(),c.reset(),i.innerHTML="",setTimeout(function(){n()},5e3)},r.onerror=function(){alert("Ошибка отправки запроса")},r.send(new FormData(e.target))):console.log(t())})});